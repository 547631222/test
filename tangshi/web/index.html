<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>我们不知道的唐诗</title>
</head>
<body>

<h1>我们不知道的唐诗</h1>
<div id="main" style="width: 600px;height:400px;"></div>
<div>
    <input id="rank" type="button" value="创作数量排行榜" >
    <input id="words" type="button" value="诗词用词云图" >
</div>
<script src="js/echarts.min.js"></script>
<script src="js/echarts-gl.min.js"></script>
<script src="js/jquery-3.3.1.min.js"></script>
<script src="js/echarts-wordcloud.min.js"></script>

<script>
    $(function() {
        $("#rank").click(function () {
            $("#rank").html("");
            $.ajax(
                {
                    method: "get",  // 发起 ajax 请求时，使用什么 http 方法
                    url: "rank.json?condtion=20",   // 请求哪个 url
                    dataType: "json",   // 返回的数据当成什么格式解析
                    success: function (data) {  // 成功后，执行什么方法
                        var names = [];
                        var counts = [];

                        for (var i in data) {
                            names.push(data[i][0]);
                            counts.push(data[i][1]);
                        }

                        //console.log(names);
                       // console.log(counts);
                        var myChart = echarts.init(document.getElementById('main'));

                        var option = {
                            // 图标的标题
                            title: {
                                text: '诗人创作数量'
                            },
                            tooltip: {},
                            legend: {
                                data: ['销量']
                            },
                            // 横坐标
                            xAxis: {
                                data: names
                            },
                            yAxis: {},
                            series: [
                                {
                                    name: '数量',
                                    type: 'bar',    // bar 代表柱状图
                                    itemStyle: {
                                        color: new echarts.graphic.LinearGradient(
                                            0, 0, 0, 1,
                                            [
                                                {offset: 0, color: '#83bff6'},
                                                {offset: 0.5, color: '#188df0'},
                                                {offset: 1, color: '#188df0'}
                                            ]
                                        )
                                    },
                                    emphasis: {
                                        itemStyle: {
                                            color: new echarts.graphic.LinearGradient(
                                                0, 0, 0, 1,
                                                [
                                                    {offset: 0, color: '#2378f7'},
                                                    {offset: 0.7, color: '#2378f7'},
                                                    {offset: 1, color: '#83bff6'}
                                                ]
                                            )
                                        }
                                    },
                                    data: counts
                                }
                            ]
                        };

                        myChart.setOption(option);

                    }
                }
            );
        });
    });

    $(function() {
        $("#words").click(function () {
            $("#rank").html("");
            $.ajax({
                method: "get",
                url: "words.json",
                dataType: "json",
                success: function (jsonData) {
                    var myChart = echarts.init(document.getElementById('main'));
                    myChart.clear();
                    var data = [];
                    for (var i in jsonData) {
                        var word = jsonData[i][0];
                        var count = jsonData[i][1];
                        data.push({
                            name: word,
                            value: count,
                            textStyle: {
                                normal: {},
                                emphasis: {}
                            }
                        });
                    }
                    console.log(data);
                    var option = {
                        series: [{
                            type: 'wordCloud',
                            shape: 'pentagon',
                            left: 'center',
                            top: 'center',
                            width: '80%',
                            height: '80%',
                            right: null,
                            bottom: null,
                            sizeRange: [12, 60],
                            rotationRange: [-90, 90],
                            rotationStep: 45,
                            gridSize: 8,
                            drawOutOfBound: false,
                            textStyle: {
                                normal: {
                                    fontFamily: 'sans-serif',
                                    fontWeight: 'bold',
                                    color: function () {
                                        return 'rgb(' + [
                                            Math.round(Math.random() * 160),
                                            Math.round(Math.random() * 160),
                                            Math.round(Math.random() * 160)
                                        ].join(',') + ')';
                                    }
                                },
                                emphasis: {
                                    shadowBlur: 10,
                                    shadowColor: '#333'
                                }
                            },
                            data: data
                        }]
                    };

                    myChart.setOption(option);

                }
            });

        })
    })




</script>
</body>
</html>